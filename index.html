<!-- Chosen Palette: Winter Solstice (Ice Blue, Slate Grey, Snow White, Sunrise Orange) -->
<!-- Application Structure Plan: A dashboard-style Single Page Application (SPA) designed for pre-trip planning and en-route reference. 
     1. Hero Section: Sets the mood and context (Winter Trip, Key Dates).
     2. Interactive Itinerary (Core): A split-view section allowing users to toggle between Day 1 and Day 2. It features a detailed timeline on the left and a synchronized Elevation Profile Chart on the right to visualize physical exertion.
     3. Preparation Hub: A gamified checklist for gear and a breakdown of logistics/costs using a Doughnut chart.
     4. Safety & Tips: Critical warnings highlighted clearly.
     This structure prioritizes 'What do I do next?' and 'How hard is the next part?' which are the most critical questions for a hiker. -->
<!-- Visualization & Content Choices:
     1. Elevation Profile (Line Chart): Goal -> Visualize physical difficulty. Method -> Chart.js Line Chart. Interaction -> Updates data based on Day 1 vs Day 2 toggle. Justification -> Hiking is about altitude; seeing the climb is more intuitive than reading meters.
     2. Budget Breakdown (Doughnut Chart): Goal -> Inform about cost distribution. Method -> Chart.js Doughnut. Interaction -> Hover for exact values. Justification -> Quick understanding of where money goes (Transport vs. Stay).
     3. Timeline (HTML/JS): Goal -> Step-by-step guidance. Method -> Styled list with JS expansion. Interaction -> Click to reveal details. Justification -> Prevents information overload.
     4. Packing List (JS Interactive Grid): Goal -> Ensure preparedness. Method -> Toggleable buttons. Interaction -> Click to mark as 'Packed'. Justification -> Active engagement ensures items aren't missed. -->
<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é»„å±±å†¬å­£ä¸¤æ—¥æ¸¸äº’åŠ¨æŒ‡å—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f1f5f9; /* Slate 100 */
            color: #1e293b; /* Slate 800 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .timeline-line {
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #cbd5e1;
            z-index: 0;
        }
        .active-tab {
            border-bottom: 2px solid #f97316;
            color: #f97316;
            font-weight: bold;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* Custom scrollbar for timeline container */
        .timeline-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .timeline-scroll::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .timeline-scroll::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

    <!-- Hero Section -->
    <header class="bg-slate-800 text-white relative overflow-hidden">
        <div class="absolute inset-0 opacity-20 bg-[url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')] bg-cover bg-center"></div>
        <div class="container mx-auto px-4 py-12 relative z-10 text-center">
            <h1 class="text-3xl md:text-5xl font-bold mb-2">ğŸ”ï¸ é»„å±±å†¬å­£è¸é›ªä¹‹æ—…</h1>
            <p class="text-slate-300 text-lg mb-6">åˆè‚¥å‡ºå‘ Â· é”™å³°ä¸¤æ—¥æ¸¸ Â· 1æœˆ24æ—¥ - 25æ—¥</p>
            <div class="flex flex-wrap justify-center gap-4 text-sm font-medium">
                <span class="bg-white/10 px-4 py-2 rounded-full border border-white/20">â„ï¸ å†¬å­£é›¾å‡‡</span>
                <span class="bg-white/10 px-4 py-2 rounded-full border border-white/20">ğŸŒ… äº‘æµ·æ—¥å‡º</span>
                <span class="bg-white/10 px-4 py-2 rounded-full border border-white/20">ğŸš¶ åå±±ä¸Šå‰å±±ä¸‹</span>
            </div>
        </div>
    </header>

    <!-- Main Navigation -->
    <nav class="sticky top-0 z-50 bg-white shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex justify-center space-x-8 text-sm md:text-base">
                <button onclick="switchView('itinerary')" id="nav-itinerary" class="active-tab py-4 px-2 transition-colors hover:text-orange-500">è¡Œç¨‹è§„åˆ’</button>
                <button onclick="switchView('prep')" id="nav-prep" class="py-4 px-2 transition-colors text-slate-500 hover:text-orange-500">è£…å¤‡ä¸é¢„ç®—</button>
                <button onclick="switchView('tips')" id="nav-tips" class="py-4 px-2 transition-colors text-slate-500 hover:text-orange-500">é‡è¦è´´å£«</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 max-w-6xl">

        <!-- VIEW 1: ITINERARY & ELEVATION -->
        <div id="view-itinerary" class="animate-fade-in block">
            <div class="mb-8 text-center max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">æ¯æ—¥è¡Œç¨‹ä¸æµ·æ‹”æ¦‚è§ˆ</h2>
                <p class="text-slate-600">æœ¬æ¿å—ç»“åˆäº†è¯¦ç»†çš„æ—¶é—´è¡¨ä¸æµ·æ‹”å˜åŒ–å›¾ã€‚ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åˆ‡æ¢æ—¥æœŸï¼ŒæŸ¥çœ‹å½“å¤©çš„å¾’æ­¥è·¯çº¿å¼ºåº¦ä¸å…³é”®èŠ‚ç‚¹ã€‚è¿™æœ‰åŠ©äºæ‚¨åˆç†åˆ†é…ä½“åŠ›ã€‚</p>
            </div>

            <!-- Day Toggle -->
            <div class="flex justify-center mb-8">
                <div class="bg-slate-200 p-1 rounded-lg inline-flex">
                    <button onclick="setDay(1)" id="btn-day1" class="px-6 py-2 rounded-md bg-white shadow-sm text-slate-800 font-medium transition-all">Day 1: ç™»é¡¶èµé›ª</button>
                    <button onclick="setDay(2)" id="btn-day2" class="px-6 py-2 rounded-md text-slate-500 hover:text-slate-700 font-medium transition-all ml-1">Day 2: ä¸‹å±±æ½èƒœ</button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left: Interactive Timeline -->
                <div class="glass-panel rounded-xl p-6 h-[500px] flex flex-col">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <span id="timeline-title" class="mr-2">ğŸ“… 1æœˆ24æ—¥ (å‘¨å…­)</span>
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">è¡Œç¨‹ç´§å‡‘</span>
                    </h3>
                    <div id="timeline-container" class="relative pl-2 overflow-y-auto timeline-scroll flex-1 pr-2">
                        <!-- Timeline Content Injected by JS -->
                    </div>
                </div>

                <!-- Right: Elevation Chart -->
                <div class="glass-panel rounded-xl p-6 flex flex-col justify-center">
                    <h3 class="text-xl font-bold mb-2">ğŸ”ï¸ æµ·æ‹”ä¸ä½“èƒ½åˆ†æ</h3>
                    <p class="text-sm text-slate-500 mb-4">å±•ç¤ºå½“å¤©ä¸»è¦æ™¯ç‚¹çš„æµ·æ‹”å˜åŒ–ï¼Œå¸®åŠ©æ‚¨é¢„ä¼°æ”€ç™»éš¾åº¦ã€‚</p>
                    
                    <div class="chart-container">
                        <canvas id="elevationChart"></canvas>
                    </div>
                    
                    <div id="day-stats" class="grid grid-cols-3 gap-4 mt-6 text-center border-t border-slate-100 pt-4">
                        <!-- Stats Injected by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 2: PREPARATION & BUDGET -->
        <div id="view-prep" class="hidden">
            <div class="mb-8 text-center max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">è¡Œå‰å‡†å¤‡ä¸é¢„ç®—</h2>
                <p class="text-slate-600">å†¬å­£é»„å±±ç¯å¢ƒç‰¹æ®Šï¼Œè£…å¤‡è‡³å…³é‡è¦ã€‚è¯·ä½¿ç”¨ä¸‹æ–¹çš„äº’åŠ¨æ¸…å•æ£€æŸ¥è¡Œæï¼Œå¹¶å‚è€ƒé¢„ç®—å›¾è¡¨è§„åˆ’å¼€æ”¯ã€‚</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Packing List -->
                <div class="glass-panel rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-4 text-orange-600">ğŸ’ æ™ºèƒ½è£…ç®±æ¸…å• (ç‚¹å‡»æ ‡è®°)</h3>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="font-semibold text-slate-700 mb-2">å¿…å¤‡è£…å¤‡ (ç”Ÿå‘½çº¿)</h4>
                            <div class="flex flex-wrap gap-2" id="pack-gear">
                                <!-- Items injected by JS -->
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-slate-700 mb-2">è¡£ç‰©ä¿æš– (æ´‹è‘±ç©¿è¡£)</h4>
                            <div class="flex flex-wrap gap-2" id="pack-clothes"></div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-slate-700 mb-2">é£Ÿå“ä¸æ‚é¡¹</h4>
                            <div class="flex flex-wrap gap-2" id="pack-food"></div>
                        </div>
                    </div>
                </div>

                <!-- Budget Chart -->
                <div class="glass-panel rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-4 text-blue-600">ğŸ’° é¢„è®¡èŠ±è´¹æ„æˆ</h3>
                    <div class="flex flex-col items-center">
                        <div class="chart-container">
                            <canvas id="budgetChart"></canvas>
                        </div>
                        <p class="text-xs text-slate-400 mt-4 text-center">* ä¼°ç®—å€¼ï¼ŒåŸºäºé€šå¸¸å±±é¡¶ä½å®¿åŠé«˜é“è´¹ç”¨ã€‚</p>
                        
                        <div class="w-full mt-6 bg-blue-50 p-4 rounded-lg text-sm text-blue-800">
                            <strong>ğŸ’¡ çœé’±è´´å£«:</strong>
                            <ul class="list-disc pl-5 mt-1 space-y-1">
                                <li>å±±é¡¶ä½å®¿æ˜¯å¤§å¤´ï¼Œè¶Šæ—©å®šè¶Šä¾¿å®œï¼Œä¹Ÿå¯è€ƒè™‘å¤šäººåºŠä½ã€‚</li>
                                <li>è‡ªçƒ­ç±³é¥­å±±ä¸‹è¶…å¸‚çº¦15å…ƒï¼Œå±±ä¸Šçº¦45å…ƒï¼Œå»ºè®®è‡ªå¤‡ã€‚</li>
                                <li>é—¨ç¥¨å­¦ç”Ÿã€è€å¹´äººæœ‰ä¼˜æƒ ï¼Œè®°å¾—å¸¦è¯ä»¶ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 3: TIPS & SAFETY -->
        <div id="view-tips" class="hidden">
             <div class="mb-8 text-center max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">å®‰å…¨é¡»çŸ¥ä¸é‡è¦æç¤º</h2>
                <p class="text-slate-600">å†¬å­£é»„å±±é£æ™¯è™½ç¾ï¼Œä½†å®‰å…¨ç¬¬ä¸€ã€‚è¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹å…³äºè·¯å†µã€å¤©æ°”å’Œè¿è¥æ—¶é—´çš„è­¦å‘Šã€‚</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-red-50 border border-red-100 rounded-xl p-6">
                    <div class="text-3xl mb-3">âš ï¸</div>
                    <h3 class="font-bold text-red-800 text-lg mb-2">å†¬å­£å…³é—­åŒºåŸŸ</h3>
                    <p class="text-red-700 text-sm leading-relaxed">
                        1. <strong>è¥¿æµ·å¤§å³¡è°·</strong>ï¼šå†¬å­£ç§¯é›ªä¸¥é‡ï¼Œè·¯æ»‘å±é™©ï¼Œé€šå¸¸å…¨çº¿å…³é—­ã€‚<br>
                        2. <strong>å¤©éƒ½å³°/è²èŠ±å³°</strong>ï¼šè½®ä¼‘æˆ–å†¬å­£ç»´æŠ¤æœŸå…³é—­ã€‚<br>
                        <span class="font-bold">åˆ‡å‹¿ç¿»è¶Šæ æ†è¿›å…¥å°é—­åŒºï¼</span>
                    </p>
                </div>

                <div class="bg-orange-50 border border-orange-100 rounded-xl p-6">
                    <div class="text-3xl mb-3">ğŸ•’</div>
                    <h3 class="font-bold text-orange-800 text-lg mb-2">æ—¶é—´ç®¡ç†çº¢çº¿</h3>
                    <p class="text-orange-700 text-sm leading-relaxed">
                        <strong>ç´¢é“åœè¿æ—¶é—´ï¼š</strong>é€šå¸¸ä¸º 16:30 - 17:00ã€‚<br>
                        é”™è¿‡ç´¢é“éœ€æ­¥è¡Œ3-4å°æ—¶ä¸‹å±±ï¼Œå¤œé—´æåº¦å±é™©ã€‚<br>
                        å»ºè®®æå‰åŠå°æ—¶åˆ°è¾¾ç´¢é“ç«™æ’é˜Ÿã€‚
                    </p>
                </div>

                <div class="bg-blue-50 border border-blue-100 rounded-xl p-6">
                    <div class="text-3xl mb-3">ğŸ§Š</div>
                    <h3 class="font-bold text-blue-800 text-lg mb-2">é˜²æ»‘ä¿æš–</h3>
                    <p class="text-blue-700 text-sm leading-relaxed">
                        <strong>å†°çˆª(é’‰é‹)</strong> æ˜¯å¿…é¡»å“ï¼é˜´é¢å°é˜¶å…¨æ˜¯æš—å†°ã€‚<br>
                        å±±ä¸Šé£é€Ÿæå¤§ï¼Œä½“æ„Ÿæ¸©åº¦å¯èƒ½ä½äºé›¶ä¸‹10åº¦ï¼ŒåŠ¡å¿…å¸¦å¸½å­å’Œæ‰‹å¥—ï¼ˆæœ€å¥½é˜²æ°´ï¼Œå¯ä»¥ç©é›ªï¼‰ã€‚
                    </p>
                </div>
            </div>

            <!-- Train Table -->
            <div class="mt-8 glass-panel rounded-xl p-6">
                <h3 class="text-lg font-bold mb-4">ğŸš„ æ¨èè½¦æ¬¡å‚è€ƒ</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th class="px-6 py-3">æ–¹å‘</th>
                                <th class="px-6 py-3">è½¦æ¬¡</th>
                                <th class="px-6 py-3">å‘è½¦æ—¶é—´</th>
                                <th class="px-6 py-3">åˆ°è¾¾æ—¶é—´</th>
                                <th class="px-6 py-3">å»ºè®®</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">å»ç¨‹ (åˆè‚¥->é»„å±±)</td>
                                <td class="px-6 py-4">G7709</td>
                                <td class="px-6 py-4">07:10</td>
                                <td class="px-6 py-4">08:50</td>
                                <td class="px-6 py-4 text-green-600">æœ€ä½³æ¨èï¼Œè¿›å±±æ—¶é—´å……è£•</td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">å»ç¨‹ (åˆè‚¥->é»„å±±)</td>
                                <td class="px-6 py-4">G7403</td>
                                <td class="px-6 py-4">07:44</td>
                                <td class="px-6 py-4">09:25</td>
                                <td class="px-6 py-4">å¤‡é€‰æ–¹æ¡ˆ</td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">è¿”ç¨‹ (é»„å±±->åˆè‚¥)</td>
                                <td class="px-6 py-4">G7194</td>
                                <td class="px-6 py-4">17:06</td>
                                <td class="px-6 py-4">18:40</td>
                                <td class="px-6 py-4">ä¸‹å±±ä¸æ…Œå¼ </td>
                            </tr>
                            <tr class="bg-white hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">è¿”ç¨‹ (é»„å±±->åˆè‚¥)</td>
                                <td class="px-6 py-4">G7316</td>
                                <td class="px-6 py-4">17:48</td>
                                <td class="px-6 py-4">19:15</td>
                                <td class="px-6 py-4">å¦‚æœä¸‹å±±è¾ƒæ™šé€‰æ­¤ç­</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-slate-800 text-slate-400 py-8 text-center mt-12">
        <p class="text-sm">Made with ğŸ’™ for your Winter Trip | æ­¤æŒ‡å—åŸºäº 1æœˆ24æ—¥-25æ—¥ è®¡åˆ’ç”Ÿæˆ</p>
        <p class="text-xs mt-2 text-slate-500">å‡ºè¡Œå‰è¯·åŠ¡å¿…å†æ¬¡æ ¸å¯¹å®˜æ–¹å¤©æ°”é¢„æŠ¥ä¸ç´¢é“å…¬å‘Š</p>
    </footer>

    <script>
        // --- DATA & STATE ---
        const state = {
            currentDay: 1,
            packedItems: new Set()
        };

        const data = {
            day1: {
                title: "1æœˆ24æ—¥ (å‘¨å…­): è¸é›ªå¯»æ¢…ï¼Œäº‘ç«¯æ¼«æ­¥",
                stats: { dist: "6km å¾’æ­¥", time: "5h æ¸¸è§ˆ", elev: "â†‘800m" },
                timeline: [
                    { time: "07:15", title: "å‡ºå‘", icon: "ğŸš„", desc: "åˆè‚¥å—ç«™ G7709/G7403 å‰å¾€é»„å±±åŒ—ç«™ã€‚" },
                    { time: "09:00", title: "æ¢ä¹˜", icon: "ğŸšŒ", desc: "é»„å±±åŒ—ç«™å®¢è¿ä¸­å¿ƒä¹˜ä¸“çº¿å¤§å·´è‡³å¯¨è¥¿æ¢ä¹˜ä¸­å¿ƒ (çº¦50åˆ†é’Ÿ)ã€‚" },
                    { time: "10:30", title: "è¿›å±±", icon: "ğŸ”ï¸", desc: "åœ¨å¯¨è¥¿å¯„å­˜è¡Œæï¼Œä¹°ç¥¨ä¹˜æ™¯åŒºå¤§å·´å‰å¾€ã€äº‘è°·å¯ºã€‘æ–¹å‘(åå±±)ã€‚" },
                    { time: "11:00", title: "ç´¢é“ä¸Šè¡Œ", icon: "ğŸš¡", desc: "ä¹˜åäº‘è°·ç´¢é“ä¸Šå±±ï¼Œä¿¯ç°é›ªæ¾ç«¹æµ·ã€‚" },
                    { time: "11:30", title: "å§‹ä¿¡å³°", icon: "ğŸŒ²", desc: "æŠµè¾¾ç™½é¹…å²­ï¼Œå¾’æ­¥è‡³å§‹ä¿¡å³°çœ‹å¥‡æ¾ï¼ˆé»‘è™æ¾ã€è¿ç†æ¾ï¼‰ã€‚" },
                    { time: "12:30", title: "åˆé¤", icon: "ğŸ±", desc: "åœ¨åŒ—æµ·å®¾é¦†é™„è¿‘ä¼‘æ¯ï¼Œåƒè‡ªå¸¦å¹²ç²®ã€‚" },
                    { time: "13:30", title: "åŒ—æµ·æ™¯åŒº", icon: "ğŸ’", desc: "æ¸¸è§ˆæ¸…å‡‰å°ã€çŒ´å­è§‚æµ·ã€‚è¿æ°”å¥½å¯è§äº‘æµ·ç¿»è…¾ã€‚" },
                    { time: "15:30", title: "æ’äº‘äº­", icon: "â„ï¸", desc: "ç»è¥¿æµ·é¥­åº—è‡³æ’äº‘äº­ï¼Œçœ‹è¥¿æµ·å¤§å³¡è°·é›ªæ™¯ï¼ˆå³¡è°·è°·åº•å…³é—­ï¼Œçœ‹ä¸€çœ¼å³å›ï¼‰ã€‚" },
                    { time: "17:15", title: "æ—¥è½", icon: "ğŸŒ…", desc: "åœ¨æ’äº‘äº­æˆ–ä¸¹éœå³°è§‚èµæ™šéœæ—¥è½ï¼Œéšåå…¥ä½é…’åº—ã€‚" }
                ],
                chartLabels: ["äº‘è°·å¯º", "ç™½é¹…å²­", "å§‹ä¿¡å³°", "åŒ—æµ·", "çŒ´å­è§‚æµ·", "æ’äº‘äº­", "ä¸¹éœå³°"],
                chartData: [890, 1650, 1680, 1610, 1700, 1605, 1700] // Approximate elevations
            },
            day2: {
                title: "1æœˆ25æ—¥ (å‘¨æ—¥): æé¡¶æ—¥å‡ºï¼Œå³¥åµ˜å‰å±±",
                stats: { dist: "8km å¾’æ­¥", time: "6h æ¸¸è§ˆ", elev: "â†“900m" },
                timeline: [
                    { time: "06:00", title: "æ—¥å‡º", icon: "â˜€ï¸", desc: "å…‰æ˜é¡¶æˆ–æ¸…å‡‰å°çœ‹æ—¥å‡ºï¼ˆå†¬å­£çº¦6:30-7:00ï¼Œéœ€æå‰å ä½ï¼‰ã€‚" },
                    { time: "08:30", title: "å…‰æ˜é¡¶", icon: "ğŸ”­", desc: "é€€æˆ¿å‡ºå‘ï¼Œç»é£æ¥çŸ³ï¼ˆçº¢æ¥¼æ¢¦å–æ™¯åœ°ï¼‰ç™»é¡¶å…‰æ˜é¡¶ï¼Œ360åº¦è§‚æ™¯ã€‚" },
                    { time: "10:00", title: "å¤©æµ·&é³Œé±¼å³°", icon: "ğŸ¢", desc: "ä¸‹è¡Œè‡³å¤©æµ·ï¼Œç¿»è¶Šé³Œé±¼å³°ï¼Œèµ°ç™¾æ­¥äº‘æ¢¯ã€‚è·¯é™¡åœ°æ»‘ï¼ŒåŠ¡å¿…ç©¿å†°çˆªï¼" },
                    { time: "12:00", title: "è¿å®¢æ¾", icon: "ğŸŒ²", desc: "æŠµè¾¾ç‰å±æ¥¼ï¼Œæ‰“å¡å›½å®è¿å®¢æ¾ï¼Œçœ‹è±¡é¼»çŸ³ã€‚" },
                    { time: "13:30", title: "ç´¢é“ä¸‹å±±", icon: "ğŸš¡", desc: "ä¹˜åç‰å±ç´¢é“ä¸‹å±±ï¼ˆå¼ºçƒˆå»ºè®®ï¼Œæ­¥è¡Œæå…¶ä¼¤è†ç›–ï¼‰ã€‚" },
                    { time: "14:30", title: "è¿”ç¨‹æ¢ä¹˜", icon: "ğŸšŒ", desc: "æ…ˆå…‰é˜ä¹˜å¤§å·´å›å¯¨è¥¿æ¢ä¹˜ä¸­å¿ƒï¼Œå–è¡Œæã€‚" },
                    { time: "15:30", title: "å‰å¾€è½¦ç«™", icon: "ğŸš•", desc: "ä¹˜å¤§å·´æˆ–æ‹¼è½¦è‡³é»„å±±åŒ—ç«™ã€‚" },
                    { time: "17:06", title: "é«˜é“è¿”ç¨‹", icon: "ğŸš„", desc: "G7194æˆ–G7316è¿”å›åˆè‚¥ï¼Œç»“æŸè¡Œç¨‹ã€‚" }
                ],
                chartLabels: ["åŒ—æµ·/è¥¿æµ·", "é£æ¥çŸ³", "å…‰æ˜é¡¶", "å¤©æµ·", "é³Œé±¼å³°", "è¿å®¢æ¾", "æ…ˆå…‰é˜"],
                chartData: [1600, 1730, 1860, 1750, 1780, 1670, 850] // Approximate elevations
            }
        };

        const packingList = {
            gear: ["èº«ä»½è¯/å­¦ç”Ÿè¯", "é˜²æ»‘å†°çˆª (å¿…å¤‡)", "ç™»å±±æ–", "å……ç”µå®", "ä¿æ¸©æ¯"],
            clothes: ["é€Ÿå¹²å†…è¡£", "æŠ“ç»’è¡£/æ¯›è¡£", "ç¾½ç»’æœ/å†²é”‹è¡£", "ä¿æš–æ‰‹å¥— (é˜²æ°´)", "æ¯›çº¿å¸½/è€³ç½©", "å›´å·¾", "ç™»å±±é‹/é›ªåœ°é´"],
            food: ["è‡ªçƒ­ç±³é¥­ (1-2ç›’)", "å·§å…‹åŠ›/å£«åŠ›æ¶", "ç‰›è‚‰å¹²", "æ°´ (é€‚é‡)"]
        };

        // --- INIT CHARTS ---
        let elevationChart = null;
        let budgetChart = null;

        function initCharts() {
            // Elevation Chart
            const ctxElev = document.getElementById('elevationChart').getContext('2d');
            elevationChart = new Chart(ctxElev, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'æµ·æ‹”é«˜åº¦ (ç±³)',
                        data: [],
                        borderColor: '#f97316',
                        backgroundColor: 'rgba(249, 115, 22, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#f97316',
                        pointRadius: 5,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `æµ·æ‹”: ${context.raw}ç±³`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 600,
                            max: 2000,
                            grid: { color: '#e2e8f0' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });

            // Budget Chart
            const ctxBudget = document.getElementById('budgetChart').getContext('2d');
            budgetChart = new Chart(ctxBudget, {
                type: 'doughnut',
                data: {
                    labels: ['äº¤é€š (é«˜é“/å¤§å·´/ç´¢é“)', 'é—¨ç¥¨ (è¿›å±±)', 'ä½å®¿ (å±±é¡¶)', 'é¤é¥®/æ‚é¡¹'],
                    datasets: [{
                        data: [600, 190, 1000, 300], // Estimated values
                        backgroundColor: [
                            '#3b82f6', // blue
                            '#10b981', // green
                            '#f97316', // orange
                            '#64748b'  // slate
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.chart._metasets[context.datasetIndex].total;
                                    const percentage = Math.round((value / total) * 100) + '%';
                                    return `${context.label}: çº¦ Â¥${value} (${percentage})`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // --- VIEW CONTROLLER ---
        function switchView(viewId) {
            // Hide all views
            document.getElementById('view-itinerary').classList.add('hidden');
            document.getElementById('view-prep').classList.add('hidden');
            document.getElementById('view-tips').classList.add('hidden');
            
            // Remove active class from nav
            document.getElementById('nav-itinerary').className = "py-4 px-2 transition-colors text-slate-500 hover:text-orange-500";
            document.getElementById('nav-prep').className = "py-4 px-2 transition-colors text-slate-500 hover:text-orange-500";
            document.getElementById('nav-tips').className = "py-4 px-2 transition-colors text-slate-500 hover:text-orange-500";

            // Show selected view and activate nav
            document.getElementById(`view-${viewId}`).classList.remove('hidden');
            document.getElementById(`nav-${viewId}`).className = "active-tab py-4 px-2 transition-colors hover:text-orange-500";
            
            // Re-render charts if needed (canvas resize fix)
            if(viewId === 'itinerary' && elevationChart) elevationChart.resize();
            if(viewId === 'prep' && budgetChart) budgetChart.resize();
        }

        // --- DAY CONTROLLER ---
        function setDay(dayNum) {
            state.currentDay = dayNum;
            const dayData = dayNum === 1 ? data.day1 : data.day2;

            // Update Buttons
            const btn1 = document.getElementById('btn-day1');
            const btn2 = document.getElementById('btn-day2');
            
            if(dayNum === 1) {
                btn1.className = "px-6 py-2 rounded-md bg-white shadow-sm text-slate-800 font-medium transition-all";
                btn2.className = "px-6 py-2 rounded-md text-slate-500 hover:text-slate-700 font-medium transition-all ml-1";
            } else {
                btn1.className = "px-6 py-2 rounded-md text-slate-500 hover:text-slate-700 font-medium transition-all mr-1";
                btn2.className = "px-6 py-2 rounded-md bg-white shadow-sm text-slate-800 font-medium transition-all";
            }

            // Update Timeline Title
            document.getElementById('timeline-title').innerText = dayData.title.split(":")[0];

            // Render Timeline
            const timelineContainer = document.getElementById('timeline-container');
            timelineContainer.innerHTML = `<div class="timeline-line"></div>`; // Reset and add line
            
            dayData.timeline.forEach((item, index) => {
                const isLast = index === dayData.timeline.length - 1;
                const html = `
                    <div class="relative pl-8 mb-6 group cursor-pointer" onclick="toggleTimelineDetail(this)">
                        <div class="absolute left-[6px] top-1 w-5 h-5 bg-white border-2 border-orange-400 rounded-full z-10 flex items-center justify-center text-[10px] group-hover:scale-110 transition-transform">
                            ${index + 1}
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-100 hover:border-orange-200 transition-colors">
                            <div class="flex justify-between items-start">
                                <div>
                                    <span class="inline-block bg-slate-100 text-slate-600 text-xs px-2 py-0.5 rounded mb-1 font-mono">${item.time}</span>
                                    <h4 class="font-bold text-slate-800">${item.icon} ${item.title}</h4>
                                </div>
                                <span class="text-orange-400 opacity-0 group-hover:opacity-100 transition-opacity text-sm">â–¼</span>
                            </div>
                            <p class="text-sm text-slate-600 mt-2 leading-relaxed">${item.desc}</p>
                        </div>
                    </div>
                `;
                timelineContainer.insertAdjacentHTML('beforeend', html);
            });

            // Update Stats
            const statsContainer = document.getElementById('day-stats');
            statsContainer.innerHTML = `
                <div><div class="text-2xl font-bold text-slate-700">${dayData.stats.dist}</div><div class="text-xs text-slate-400">è·ç¦»</div></div>
                <div><div class="text-2xl font-bold text-slate-700">${dayData.stats.time}</div><div class="text-xs text-slate-400">æ—¶é•¿</div></div>
                <div><div class="text-2xl font-bold text-orange-500">${dayData.stats.elev}</div><div class="text-xs text-slate-400">æµ·æ‹”å˜åŒ–</div></div>
            `;

            // Update Chart
            if(elevationChart) {
                elevationChart.data.labels = dayData.chartLabels;
                elevationChart.data.datasets[0].data = dayData.chartData;
                elevationChart.update();
            }
        }

        function toggleTimelineDetail(element) {
            // Optional: Add specific interaction logic here if we wanted detailed expansion
            // Currently using a simple hover/card effect
            element.querySelector('.bg-white').classList.toggle('ring-2');
            element.querySelector('.bg-white').classList.toggle('ring-orange-200');
        }

        // --- PACKING LIST ---
        function renderPackingList() {
            const createItem = (id, text, category) => {
                const btn = document.createElement('button');
                btn.className = "px-3 py-1.5 rounded-full text-sm border transition-all text-slate-600 border-slate-300 hover:border-orange-400 hover:text-orange-500 bg-white";
                btn.innerHTML = `<span>â—‹</span> ${text}`;
                btn.onclick = () => {
                    if(state.packedItems.has(id)) {
                        state.packedItems.delete(id);
                        btn.className = "px-3 py-1.5 rounded-full text-sm border transition-all text-slate-600 border-slate-300 hover:border-orange-400 hover:text-orange-500 bg-white";
                        btn.innerHTML = `<span>â—‹</span> ${text}`;
                    } else {
                        state.packedItems.add(id);
                        btn.className = "px-3 py-1.5 rounded-full text-sm border transition-all text-white bg-green-500 border-green-600 shadow-sm";
                        btn.innerHTML = `<span>âœ“</span> ${text}`;
                    }
                };
                return btn;
            };

            const gearContainer = document.getElementById('pack-gear');
            packingList.gear.forEach((item, i) => gearContainer.appendChild(createItem(`g${i}`, item, 'gear')));

            const clothesContainer = document.getElementById('pack-clothes');
            packingList.clothes.forEach((item, i) => clothesContainer.appendChild(createItem(`c${i}`, item, 'clothes')));

            const foodContainer = document.getElementById('pack-food');
            packingList.food.forEach((item, i) => foodContainer.appendChild(createItem(`f${i}`, item, 'food')));
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            initCharts();
            setDay(1);
            renderPackingList();
        };

    </script>
</body>
</html>